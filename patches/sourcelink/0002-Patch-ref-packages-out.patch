From 8a75e873fbfeb41db195b62f82d59ffe117c5e78 Mon Sep 17 00:00:00 2001
From: Chris Rummel <crummel@microsoft.com>
Date: Fri, 6 Dec 2019 15:07:09 -0600
Subject: [PATCH 2/3] Patch ref packages out.

---
 eng/Versions.props                                   |  2 +-
 .../Microsoft.Build.Tasks.Git.csproj                 |  2 +-
 .../Microsoft.Build.Tasks.Tfvc.nuspec                | 12 +-----------
 .../Microsoft.SourceLink.Bitbucket.Git.csproj        |  2 +-
 .../Microsoft.SourceLink.Bitbucket.Git.nuspec        |  3 +--
 .../Microsoft.SourceLink.Common.csproj               |  2 +-
 .../Microsoft.SourceLink.Common.nuspec               |  4 +---
 .../Microsoft.SourceLink.GitHub.csproj               |  2 +-
 .../Microsoft.SourceLink.GitHub.nuspec               |  3 +--
 .../Microsoft.SourceLink.GitLab.csproj               |  2 +-
 .../Microsoft.SourceLink.GitLab.nuspec               |  3 +--
 .../Microsoft.SourceLink.Tfs.Git.csproj              |  2 +-
 .../Microsoft.SourceLink.Tfs.Git.nuspec              |  3 +--
 .../Microsoft.SourceLink.Vsts.Git.csproj             |  2 +-
 .../Microsoft.SourceLink.Vsts.Git.nuspec             |  3 +--
 .../Microsoft.SourceLink.Vsts.Tfvc.csproj            |  2 +-
 .../Microsoft.SourceLink.Vsts.Tfvc.nuspec            |  3 +--
 17 files changed, 17 insertions(+), 35 deletions(-)

diff --git a/eng/Versions.props b/eng/Versions.props
index a02d515..1b694ff 100644
--- a/eng/Versions.props
+++ b/eng/Versions.props
@@ -6,7 +6,7 @@
     <PreReleaseVersionLabel>beta2</PreReleaseVersionLabel>
     <SemanticVersioningV1>true</SemanticVersioningV1>
     <!-- Opt-in repo features -->
-    <UsingToolNetFrameworkReferenceAssemblies>true</UsingToolNetFrameworkReferenceAssemblies>
+    <UsingToolNetFrameworkReferenceAssemblies>false</UsingToolNetFrameworkReferenceAssemblies>
     <UsingToolSymbolUploader>true</UsingToolSymbolUploader>
     <XUnitVersion>2.4.1</XUnitVersion>
     <!-- 
diff --git a/src/Microsoft.Build.Tasks.Git/Microsoft.Build.Tasks.Git.csproj b/src/Microsoft.Build.Tasks.Git/Microsoft.Build.Tasks.Git.csproj
index 5e60db7..ce04ccb 100644
--- a/src/Microsoft.Build.Tasks.Git/Microsoft.Build.Tasks.Git.csproj
+++ b/src/Microsoft.Build.Tasks.Git/Microsoft.Build.Tasks.Git.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
     
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/Microsoft.Build.Tasks.Tfvc/Microsoft.Build.Tasks.Tfvc.nuspec b/src/Microsoft.Build.Tasks.Tfvc/Microsoft.Build.Tasks.Tfvc.nuspec
index 236c295..fab442a 100644
--- a/src/Microsoft.Build.Tasks.Tfvc/Microsoft.Build.Tasks.Tfvc.nuspec
+++ b/src/Microsoft.Build.Tasks.Tfvc/Microsoft.Build.Tasks.Tfvc.nuspec
@@ -4,17 +4,7 @@
     $CommonMetadataElements$
   </metadata>
   <files>
-    <file src="net46\Microsoft.Build.Tasks.Tfvc.*" target="tools\net46" />
-    <file src="net46\Microsoft.TeamFoundation.Client.dll" target="tools\net46" />
-    <file src="net46\Microsoft.TeamFoundation.Common.dll" target="tools\net46" />
-    <file src="net46\Microsoft.TeamFoundation.Core.WebApi.dll" target="tools\net46" />
-    <file src="net46\Microsoft.TeamFoundation.VersionControl.Client.dll" target="tools\net46" />
-    <file src="net46\Microsoft.TeamFoundation.VersionControl.Common.dll" target="tools\net46" />
-    <file src="net46\Microsoft.VisualStudio.Services.Client.Interactive.dll" target="tools\net46" />
-    <file src="net46\Microsoft.VisualStudio.Services.Common.dll" target="tools\net46" />
-    <file src="net46\Microsoft.VisualStudio.Services.WebApi.dll" target="tools\net46" />
-
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\build\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.csproj b/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.csproj
index 7abd791..1147bcb 100644
--- a/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.csproj
+++ b/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.nuspec b/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.nuspec
index 783d9db..f1193bd 100644
--- a/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.nuspec
+++ b/src/SourceLink.Bitbucket.Git/Microsoft.SourceLink.Bitbucket.Git.nuspec
@@ -9,9 +9,8 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.Common/Microsoft.SourceLink.Common.csproj b/src/SourceLink.Common/Microsoft.SourceLink.Common.csproj
index 7d8a979..5b2232c 100644
--- a/src/SourceLink.Common/Microsoft.SourceLink.Common.csproj
+++ b/src/SourceLink.Common/Microsoft.SourceLink.Common.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.Common/Microsoft.SourceLink.Common.nuspec b/src/SourceLink.Common/Microsoft.SourceLink.Common.nuspec
index 382b926..83283a6 100644
--- a/src/SourceLink.Common/Microsoft.SourceLink.Common.nuspec
+++ b/src/SourceLink.Common/Microsoft.SourceLink.Common.nuspec
@@ -6,9 +6,7 @@
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.Common.*" target="tools\netcoreapp2.0" />
 
-    <file src="net461\Microsoft.SourceLink.Common.*" target="tools\net461" />
-
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.csproj b/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.csproj
index 7e4bf97..766af6f 100644
--- a/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.csproj
+++ b/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.nuspec b/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.nuspec
index 783d9db..f1193bd 100644
--- a/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.nuspec
+++ b/src/SourceLink.GitHub/Microsoft.SourceLink.GitHub.nuspec
@@ -9,9 +9,8 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.csproj b/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.csproj
index 39fd6d1..8281645 100644
--- a/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.csproj
+++ b/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.nuspec b/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.nuspec
index 783d9db..f1193bd 100644
--- a/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.nuspec
+++ b/src/SourceLink.GitLab/Microsoft.SourceLink.GitLab.nuspec
@@ -9,9 +9,8 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.csproj b/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.csproj
index eb6d85a..baabf1c 100644
--- a/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.csproj
+++ b/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.nuspec b/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.nuspec
index 783d9db..f1193bd 100644
--- a/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.nuspec
+++ b/src/SourceLink.Tfs.Git/Microsoft.SourceLink.Tfs.Git.nuspec
@@ -9,9 +9,8 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.csproj b/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.csproj
index 65bfb3b..a5e6962 100644
--- a/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.csproj
+++ b/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.nuspec b/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.nuspec
index 783d9db..f1193bd 100644
--- a/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.nuspec
+++ b/src/SourceLink.Vsts.Git/Microsoft.SourceLink.Vsts.Git.nuspec
@@ -9,9 +9,8 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
     <file src="$ProjectDirectory$\buildCrossTargeting\*.*" target="buildCrossTargeting" />
   </files>
-</package>
\ No newline at end of file
+</package>
diff --git a/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.csproj b/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.csproj
index df36573..e37e305 100644
--- a/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.csproj
+++ b/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.csproj
@@ -1,6 +1,6 @@
 ﻿<Project Sdk="Microsoft.NET.Sdk">
   <PropertyGroup>
-    <TargetFrameworks>net461;netcoreapp2.0</TargetFrameworks>
+    <TargetFrameworks>netcoreapp2.0</TargetFrameworks>
     <AutoGenerateAssemblyVersion>true</AutoGenerateAssemblyVersion>
 
     <!-- Using an explicit nuspec file since NuGet Pack target currently doesn't support including dependencies in tools packages -->
diff --git a/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.nuspec b/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.nuspec
index 06c212b..d1f6b93 100644
--- a/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.nuspec
+++ b/src/SourceLink.Vsts.Tfvc/Microsoft.SourceLink.Vsts.Tfvc.nuspec
@@ -9,8 +9,7 @@
   </metadata>
   <files>
     <file src="netcoreapp2.0\publish\**\Microsoft.SourceLink.*" target="tools\netcoreapp2.0" />
-    <file src="net461\**\Microsoft.SourceLink.*" target="tools\net461" />
 
     <file src="$ProjectDirectory$\build\*.*" target="build" />
   </files>
-</package>
\ No newline at end of file
+</package>
-- 
2.18.2

